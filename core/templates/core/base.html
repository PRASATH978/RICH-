<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MyApp - Your go-to app for amazing features.">
    <meta name="keywords" content="MyApp, features, amazing app, login, register">
    <meta name="author" content="MyApp Team">
    <title>{% block title %}My App{% endblock %}</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>


    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

    <!-- Sticky Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top shadow-sm">
        <div class="container">
            <!-- Logo and Brand -->
            <a class="navbar-brand d-flex align-items-center gap-2" href="{% url 'home' %}">
                <!-- Logo Image -->
                <img src="" alt="Logo" width="30" height="30" class="d-inline-block align-text-top">
                MyApp
            </a>
            <!-- Navbar Toggler -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Nav Links -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    {% if user.is_authenticated %}
                        <li class="nav-item">
                            <a class="nav-link" href="#">Welcome, {{ user.username }}</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'logout' %}">Logout</a>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'login' %}">Login</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'register' %}">Register</a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mt-4">
        {% block content %}
        {% endblock %}
    </main>


    <!-- Product List -->
<div class="row">
  
    
    <!-- Loading Spinner -->
    <div id="loading-spinner" class="text-center my-5" style="display: none;">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
    
    <div id="product-list" class="row">
      <!-- Products will be dynamically loaded here -->
    </div>
    
    <!-- Pagination -->
    <div id="pagination" class="d-flex justify-content-center my-4">
      <!-- Pagination controls will be here -->
    </div>
  </div>
  

    <!-- Footer -->
    <footer class="text-center text-muted mt-5 mb-3">
        <small>&copy; {% now "Y" %} {{ site_name|default:"MyApp" }}. All rights reserved.</small>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Add this before closing </body> tag -->
<script >
// Sample data for winner money amounts
const moneyAmounts = [100, 500, 350, 800, 400, 100];

// Function to generate random winners
function generateRandomWinners() {
  const randomIndex = Math.floor(Math.random() * moneyAmounts.length);
  return moneyAmounts[randomIndex];
}

// Display random winners in the marquee
function updateMarquee() {
  const winnerMessage = "Global Winners: ";
  const numberOfWinners = 10; // Adjust how many winners to show
  let winnersText = winnerMessage;
  
  for (let i = 0; i < numberOfWinners; i++) {
    winnersText += `User ${i + 1}: $${generateRandomWinners()} | `;
  }
  
  // Update the marquee with the winners' data
  document.getElementById('winner-marquee').textContent = winnersText;
}

// Call updateMarquee function every 3 seconds
setInterval(updateMarquee, 3000);

// Initial call to update the marquee
updateMarquee();




document.addEventListener("DOMContentLoaded", function () {
  const spinner = document.getElementById('loading-spinner');
  const productList = document.getElementById('product-list');
  const pagination = document.getElementById('pagination');
  
  // Simulate fetching products (replace with actual fetch or Ajax request)
  setTimeout(function() {
    // Hide the spinner
    spinner.style.display = 'none';

    // Example: Adding some dummy products (replace with actual dynamic data)
    const products = [
      { name: 'Product 1', price: 100, nye_price: 120, image: '/path/to/image1.jpg' },
      { name: 'Product 2', price: 200, nye_price: 220, image: '/path/to/image2.jpg' }
    ];

    // Render products
    let productHtml = '';
    products.forEach(product => {
      productHtml += `
        <div class="col-md-6 col-lg-4 col-xl-3 mb-4">
          <div class="card shadow-sm h-100">
            <div class="card-body bg-light">
              <strong>Product Name:</strong> ${product.name}<br>
              <img src="${product.image}" class="img-fluid my-2" alt="Product Image">
              <p class="card-text">
                <strong>Price:</strong> ₹${product.price}<br>
                <strong>NYE Price:</strong> ₹${product.nye_price}<br>
              </p>
             <button class="btn btn-primary btn-sm buy-now-btn"
        data-name="${product.name}"
        data-price="${product.price}"
        data-product-id="1">Buy Now</button>

            </div>
          </div>
        </div>
      `;
    });

    productList.innerHTML = productHtml;

    // Display pagination controls (example)
    pagination.innerHTML = `
      <nav aria-label="Page navigation">
        <ul class="pagination">
          <li class="page-item"><a class="page-link" href="#">Previous</a></li>
          <li class="page-item"><a class="page-link" href="#">1</a></li>
          <li class="page-item"><a class="page-link" href="#">2</a></li>
          <li class="page-item"><a class="page-link" href="#">Next</a></li>
        </ul>
      </nav>
    `;
  }, 3000); // Simulate 3 seconds delay (replace with actual data fetch)
});



document.addEventListener('click', function (e) {
  if (e.target.classList.contains('buy-now-btn')) {
    const button = e.target;
    const productName = button.getAttribute('data-name');
    const price = parseFloat(button.getAttribute('data-price')) * 100; // Razorpay expects paise
    const productId = button.getAttribute('data-product-id');

    const options = {
      key: "rzp_test_DRwaqstb1kW0T3", // Replace with your Razorpay key
      amount: price,
      currency: "INR",
      name: "MyApp Store",
      description: productName,
      handler: function (response) {
        alert("Payment successful!\nRazorpay Payment ID: " + response.razorpay_payment_id);

        // Send to backend if needed
        /*
        fetch("/payment-success/", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": "{{ csrf_token }}"
          },
          body: JSON.stringify({
            product_id: productId,
            payment_id: response.razorpay_payment_id
          })
        });
        */
      },
      prefill: {
        name: "{{ user.username }}",
        email: "{{ user.email }}"
      },
      theme: {
        color: "#0d6efd"
      }
    };

    const rzp = new Razorpay(options);
    rzp.open();
    e.preventDefault();
  }
});
</script>
</body>
</html>
